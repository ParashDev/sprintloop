<!DOCTYPE html>
<html lang="en">
<head>
  <script>(()=>{if(localStorage.getItem('po-toolkit-theme')!=='light')document.documentElement.classList.add('dark')})()</script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Project Dashboard - SprintLoop | Sprint Analytics & Metrics</title>
  <meta name="description" content="Visualize your agile project health at a glance. Track sprint velocity, story progress, risk heatmaps, and epic completion in one unified dashboard.">
  <link rel="canonical" href="https://sprintloop.dplooy.com/pages/dashboard.html">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            surface: { light: '#f8fafc', dark: '#1e293b' },
          }
        }
      }
    }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../styles/shared.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    .font-serif { font-family: 'Instrument Serif', serif; }
    .kpi-card { position: relative; overflow: hidden; }
    .kpi-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 3px;
      border-radius: 4px 4px 0 0;
    }
    .kpi-stories::before { background: #3b82f6; }
    .kpi-sprint::before { background: #10b981; }
    .kpi-risks::before { background: #ef4444; }
    .kpi-actions::before { background: #f59e0b; }
    .progress-ring { transition: stroke-dashoffset 0.6s ease; }
  </style>
</head>
<body class="bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-100 min-h-screen">

  <!-- Nav injected by JS -->
  <div id="page-header"></div>

  <!-- No project state -->
  <div id="no-project-state" class="hidden">
    <div class="max-w-md mx-auto text-center py-24 px-6">
      <div class="w-16 h-16 mx-auto mb-6 rounded-2xl bg-slate-100 dark:bg-slate-800 flex items-center justify-center">
        <svg class="w-8 h-8 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
      </div>
      <h2 class="text-xl font-semibold mb-2">No Project Selected</h2>
      <p class="text-slate-500 dark:text-slate-400 mb-6">Select or create a project to see your dashboard analytics.</p>
      <a href="business-docs.html" class="inline-flex items-center gap-2 px-5 py-2.5 rounded-lg bg-slate-900 dark:bg-white text-white dark:text-slate-900 text-sm font-medium hover:opacity-90 transition-opacity">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
        Create a Project
      </a>
    </div>
  </div>

  <!-- Dashboard content -->
  <div id="dashboard-content" class="hidden">
    <main class="max-w-7xl mx-auto px-4 sm:px-6 py-6 space-y-6">

      <!-- KPI Row -->
      <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
        <div id="kpi-stories" class="kpi-card kpi-stories bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5">
          <div class="flex items-center justify-between mb-3">
            <span class="text-xs font-medium uppercase tracking-wider text-slate-400">Stories</span>
            <svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
          </div>
          <div class="text-3xl font-bold mb-1" id="kpi-stories-count">0</div>
          <div class="text-xs text-slate-500 dark:text-slate-400" id="kpi-stories-breakdown"></div>
        </div>
        <div id="kpi-sprint" class="kpi-card kpi-sprint bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5">
          <div class="flex items-center justify-between mb-3">
            <span class="text-xs font-medium uppercase tracking-wider text-slate-400">Sprint</span>
            <svg class="w-4 h-4 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
          </div>
          <div class="text-3xl font-bold mb-1" id="kpi-sprint-pct">--</div>
          <div class="text-xs text-slate-500 dark:text-slate-400" id="kpi-sprint-label"></div>
        </div>
        <div id="kpi-risks" class="kpi-card kpi-risks bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5">
          <div class="flex items-center justify-between mb-3">
            <span class="text-xs font-medium uppercase tracking-wider text-slate-400">Open Risks</span>
            <svg class="w-4 h-4 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4.5c-.77-.833-2.694-.833-3.464 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"/></svg>
          </div>
          <div class="text-3xl font-bold mb-1" id="kpi-risks-count">0</div>
          <div class="text-xs text-slate-500 dark:text-slate-400" id="kpi-risks-label"></div>
        </div>
        <div id="kpi-actions" class="kpi-card kpi-actions bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5">
          <div class="flex items-center justify-between mb-3">
            <span class="text-xs font-medium uppercase tracking-wider text-slate-400">Action Items</span>
            <svg class="w-4 h-4 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/></svg>
          </div>
          <div class="text-3xl font-bold mb-1" id="kpi-actions-count">0</div>
          <div class="text-xs text-slate-500 dark:text-slate-400" id="kpi-actions-label"></div>
        </div>
      </div>

      <!-- Charts Row -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
        <div class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-sm font-semibold">Story Status</h3>
            <a href="user-stories.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">View stories</a>
          </div>
          <div id="velocity-chart-wrap" class="h-56 relative">
            <canvas id="velocity-chart"></canvas>
            <div id="velocity-empty" class="hidden absolute inset-0 flex items-center justify-center">
              <div class="text-center">
                <p class="text-sm text-slate-400 mb-2">No stories created yet</p>
                <a href="user-stories.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">Create stories</a>
              </div>
            </div>
          </div>
        </div>
        <div class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-sm font-semibold">Story Priority Breakdown</h3>
            <a href="user-stories.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">View stories</a>
          </div>
          <div id="priority-chart-wrap" class="h-56 relative flex items-center justify-center">
            <canvas id="priority-chart"></canvas>
            <div id="priority-empty" class="hidden absolute inset-0 flex items-center justify-center">
              <div class="text-center">
                <p class="text-sm text-slate-400 mb-2">No stories created yet</p>
                <a href="user-stories.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">Create stories</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Team Distribution + Sprint Board Summary -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
        <div class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-sm font-semibold">Team Distribution</h3>
            <a href="capacity-planner.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">Manage team</a>
          </div>
          <div id="team-chart-wrap" class="h-48 relative flex items-center justify-center">
            <canvas id="team-chart"></canvas>
            <div id="team-empty" class="hidden absolute inset-0 flex items-center justify-center">
              <div class="text-center">
                <p class="text-sm text-slate-400 mb-2">No team members added</p>
                <a href="capacity-planner.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">Add team</a>
              </div>
            </div>
          </div>
        </div>
        <div class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-sm font-semibold">Sprint Board Summary</h3>
            <a href="sprint-board.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">View board</a>
          </div>
          <div id="board-summary">
            <div id="board-summary-empty" class="hidden text-center py-8">
              <p class="text-sm text-slate-400 mb-2">No sprint items yet</p>
              <a href="sprint-board.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">Go to Sprint Board</a>
            </div>
            <div id="board-summary-bars" class="space-y-3"></div>
          </div>
        </div>
      </div>

      <!-- Risk Overview + Recent Decisions (side by side) -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
        <div class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-sm font-semibold">Risk Overview</h3>
            <a href="risk-register.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">View all</a>
          </div>
          <div id="risk-summary-empty" class="hidden text-center py-8">
            <p class="text-sm text-slate-400 mb-2">No risks tracked yet</p>
            <a href="risk-register.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">Add risks</a>
          </div>
          <div id="risk-summary-content" class="hidden"></div>
        </div>
        <div class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-sm font-semibold">Recent Decisions</h3>
            <a href="retro-log.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">View all</a>
          </div>
          <div id="decisions-widget">
            <div id="decisions-empty" class="hidden text-center py-8">
              <p class="text-sm text-slate-400 mb-2">No decisions logged yet</p>
              <a href="retro-log.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">Log a decision</a>
            </div>
            <div id="decisions-list" class="space-y-2"></div>
          </div>
        </div>
      </div>

      <!-- Epic Progress (full width) -->
      <div class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-5">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-sm font-semibold">Epic Progress</h3>
          <a href="epics.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">View epics</a>
        </div>
        <div id="epic-progress">
          <div id="epic-progress-empty" class="hidden text-center py-8">
            <p class="text-sm text-slate-400 mb-2">No epics created yet</p>
            <a href="epics.html" class="text-xs text-blue-500 hover:text-blue-400 transition-colors">Create epics</a>
          </div>
          <div id="epic-progress-list" class="space-y-3"></div>
        </div>
      </div>

    </main>
  </div>

  <script src="../scripts/shared.js"></script>
  <script src="../scripts/dashboard.js"></script>
</body>
</html>
